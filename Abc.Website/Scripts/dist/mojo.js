/*!
 * Mojo JavaScript Microframework
 * 
 * Copyright 2012 Agile Business Cloud Solutions Ltd.

 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *    http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var Mustache;(function(a){if(typeof module!=="undefined"){module.exports=a;}else{if(typeof define==="function"){define(a);}else{Mustache=a;}}}((function(){var A={};A.name="mustache.js";A.version="0.5.2";A.tags=["{{","}}"];A.parse=o;A.clearCache=y;A.compile=h;A.compilePartial=k;A.render=z;A.Scanner=v;A.Context=s;A.Renderer=t;A.to_html=function(F,D,E,G){var C=z(F,D,E);if(typeof G==="function"){G(C);}else{return C;}};var c=/\s*/;var m=/\s+/;var i=/\S/;var g=/\s*=/;var p=/\s*\}/;var u=/#|\^|\/|>|\{|&|=|!/;function q(D,C){return RegExp.prototype.test.call(D,C);}function f(C){return !q(i,C);}var j=Array.isArray||function(C){return Object.prototype.toString.call(C)==="[object Array]";};var l=/[\x00-\x2F\x3A-\x40\x5B-\x60\x7B-\xFF\u2028\u2029]/gm;function x(D){var C=D.replace(l,function(E){return"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4);});return'"'+C+'"';}function e(C){return C.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");}var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function n(C){return String(C).replace(/[&<>"'\/]/g,function(D){return b[D];});}A.isWhitespace=f;A.isArray=j;A.quote=x;A.escapeRe=e;A.escapeHtml=n;function v(C){this.string=C;this.tail=C;this.pos=0;}v.prototype.eos=function(){return this.tail==="";};v.prototype.scan=function(D){var C=this.tail.match(D);if(C&&C.index===0){this.tail=this.tail.substring(C[0].length);this.pos+=C[0].length;return C[0];}return"";};v.prototype.scanUntil=function(D){var C,E=this.tail.search(D);switch(E){case -1:C=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:C="";break;default:C=this.tail.substring(0,E);this.tail=this.tail.substring(E);this.pos+=E;}return C;};function s(C,D){this.view=C;this.parent=D;this.clearCache();}s.make=function(C){return(C instanceof s)?C:new s(C);};s.prototype.clearCache=function(){this._cache={};};s.prototype.push=function(C){return new s(C,this);};s.prototype.lookup=function(C){var F=this._cache[C];if(!F){if(C==="."){F=this.view;}else{var E=this;while(E){if(C.indexOf(".")>0){var G=C.split("."),D=0;F=E.view;while(F&&D<G.length){F=F[G[D++]];}}else{F=E.view[C];}if(F!=null){break;}E=E.parent;}}this._cache[C]=F;}if(typeof F==="function"){F=F.call(this.view);}return F;};function t(){this.clearCache();}t.prototype.clearCache=function(){this._cache={};this._partialCache={};};t.prototype.compile=function(F,D){if(typeof F==="string"){F=o(F,D);}var E=d(F),C=this;return function(G){return E(s.make(G),C);};};t.prototype.compilePartial=function(D,E,C){this._partialCache[D]=this.compile(E,C);return this._partialCache[D];};t.prototype.render=function(E,C){var D=this._cache[E];if(!D){D=this.compile(E);this._cache[E]=D;}return D(C);};t.prototype._section=function(C,D,K){var J=D.lookup(C);switch(typeof J){case"object":if(j(J)){var F="";for(var G=0,I=J.length;G<I;++G){F+=K(D.push(J[G]),this);}return F;}return J?K(D.push(J),this):"";case"function":var E=K(D,this),L=this;var H=function(M){return L.render(M,D);};return J.call(D.view,E,H)||"";default:if(J){return K(D,this);}}return"";};t.prototype._inverted=function(C,D,F){var E=D.lookup(C);if(E==null||E===false||(j(E)&&E.length===0)){return F(D,this);}return"";};t.prototype._partial=function(C,D){var E=this._partialCache[C];if(E){return E(D);}return"";};t.prototype._name=function(D,E,F){var G=E.lookup(D);if(typeof G==="function"){G=G.call(E.view);}var C=(G==null)?"":String(G);if(F){return n(C);}return C;};function d(H,I){var D=['""'];var F,J,G;for(var E=0,C=H.length;E<C;++E){F=H[E];switch(F.type){case"#":case"^":J=(F.type==="#")?"_section":"_inverted";D.push("r."+J+"("+x(F.value)+", c, function (c, r) {\n  "+d(F.tokens,true)+"\n})");break;case"{":case"&":case"name":G=F.type==="name"?"true":"false";D.push("r._name("+x(F.value)+", c, "+G+")");break;case">":D.push("r._partial("+x(F.value)+", c)");break;case"text":D.push(x(F.value));break;}}D="return "+D.join(" + ")+";";if(I){return D;}return new Function("c, r",D);}function r(C){if(C.length===2){return[new RegExp(e(C[0])+"\\s*"),new RegExp("\\s*"+e(C[1]))];}throw new Error("Invalid tags: "+C.join(" "));}function B(H){var C=[];var G=C;var I=[];var E,F;for(var D=0;D<H.length;++D){E=H[D];switch(E.type){case"#":case"^":E.tokens=[];I.push(E);G.push(E);G=E.tokens;break;case"/":if(I.length===0){throw new Error("Unopened section: "+E.value);}F=I.pop();if(F.value!==E.value){throw new Error("Unclosed section: "+F.value);}if(I.length>0){G=I[I.length-1].tokens;}else{G=C;}break;default:G.push(E);}}F=I.pop();if(F){throw new Error("Unclosed section: "+F.value);}return C;}function a(F){var C;for(var E=0;E<F.length;++E){var D=F[E];if(C&&C.type==="text"&&D.type==="text"){C.value+=D.value;F.splice(E--,1);}else{C=D;}}}function o(N,P){P=P||A.tags;var O=r(P);var E=new v(N);var L=[],J=[],H=false,Q=false;var C=function(){if(H&&!Q){while(J.length){L.splice(J.pop(),1);}}else{J=[];}H=false;Q=false;};var K,M,F;while(!E.eos()){M=E.scanUntil(O[0]);if(M){for(var G=0,I=M.length;G<I;++G){F=M.charAt(G);if(f(F)){J.push(L.length);}else{Q=true;}L.push({type:"text",value:F});if(F==="\n"){C();}}}if(!E.scan(O[0])){break;}H=true;K=E.scan(u)||"name";E.scan(c);if(K==="="){M=E.scanUntil(g);E.scan(g);E.scanUntil(O[1]);}else{if(K==="{"){var D=new RegExp("\\s*"+e("}"+P[1]));M=E.scanUntil(D);E.scan(p);E.scanUntil(O[1]);}else{M=E.scanUntil(O[1]);}}if(!E.scan(O[1])){throw new Error("Unclosed tag at "+E.pos);}L.push({type:K,value:M});if(K==="name"||K==="{"||K==="&"){Q=true;}if(K==="="){P=M.split(m);O=r(P);}}a(L);return B(L);}var w=new t();function y(){w.clearCache();}function h(D,C){return w.compile(D,C);}function k(D,E,C){return w.compilePartial(D,E,C);}function z(F,C,E){if(E){for(var D in E){k(D,E[D]);}}return w.render(F,C);}return A;}())));(function(g,j){var e=jQuery;var o=function(){};o.controllers={};o.applications={};o.options={};o._loaded=[];o.resolve=function m(p){if(!o._namespace._provided[p]){return p.replace(/\./gi,"/");}return false;};o._namespace=function d(s){var t=(""+s).split(/\./),v=t.length,u=[],r=window||{};if(!o._namespace._provided){o._namespace._provided={};}if(o._namespace._provided[s]==s){throw new Error(s+" has already been defined.");}for(var q=0;q<v;q+=1){var p=t[q];if(!r[p]){u[q]=p;r[p]=function(){};o._namespace._provided[u.join(".")]=r[p];}r=r[p];}return r;};o.template=function l(q,r,p){if("undefined"==typeof Mustache){return false;}if("undefined"==typeof q||!q){throw new Error("'template' is required");}if("undefined"==typeof r||!r){throw new Error("'data' is required");}return Mustache.to_html(q,r,p);};o.query=function i(){if(!arguments.length){return false;}return e.apply(this,arguments);};o.queryFirst=function b(){if(!arguments.length){return false;}var p=o.query.apply(this,arguments);if(!p.length){return false;}return p[0];};o.guid=function h(){var q=[],r="0123456789ABCDEF";for(var p=0;p<36;p++){q[p]=Math.floor(Math.random()*16);}q[14]=4;q[19]=(q[19]&3)|8;for(var p=0;p<36;p++){q[p]=r[q[p]];}q[8]=q[13]=q[18]=q[23]="-";return q.join("");};o.require=function c(t,w){if("undefined"==typeof t||!t){throw new Error("'dependencies' is required");}if("undefined"==typeof w||!w){throw new Error("'callback' is required");}if(!e.isArray(t)){t=[t];}var v=t.length,x,s=0;var p=o.controllers;for(var r=0;r<v;r++){var u=t[r];x=o.options.baseSrc+o.resolve(u)+".js";o._loaded.push(u);e.getScript(x,function(){s++;});}var q=setInterval(function(){if(w&&s==v){clearInterval(q);w.call(this);}},25);};o.requireSync=function k(p){var q=o.options.baseSrc+o.resolve(p)+".js";e.ajaxSetup({async:false});e.getScript(q);e.ajaxSetup({async:true});};o.getController=function n(p){if("undefined"==typeof o.controllers[p]){return false;}if("string"!=typeof p){return false;}return o.controllers[p];};o.fetch=function a(p,q){e.getScript(p,function(){if(q){q.apply(this,arguments);}});};o.define=function(q,p){if("undefined"==typeof q||!q){throw new Error("'id' is required");}if("undefined"==typeof p||!p){throw new Error(q+" missing factory implementation");}if("function"==typeof p){p=p.call(this,jQuery);}if("string"!=typeof q){return false;}if("string"==typeof q){o._namespace(q);o._loaded[q]=p;o.controllers[q]=p;}};o.create=function f(p){if(arguments.length>1){throw new Error("Incorrect arguments");}if("undefined"==typeof p){p={};if(!p.baseSrc){p.baseSrc="js/";}}e.extend(this.options,p);return new o.Application();};if(window){window.mojo=o;}})(window,document);mojo.define("mojo.helper",function(c){var b={};b.isUrl=function d(e){if(!e){return false;}return/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e);};b.isEmail=function a(e){if(!e){return false;}return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(e);};mojo.helper=b;});mojo.define("mojo.Messaging",function(){var c=jQuery,b=c({}),a=function(){};a.subscribe=function(){b.bind.apply(b,arguments);};a.unsubscribe=function(){b.unbind.apply(b,arguments);};a.publish=function(){b.trigger.apply(b,arguments);};mojo.Messaging=a;});mojo.define("mojo.Model",function(){var a=jQuery,b=function(){};b.set=function(c,e){var f=mojo.query('*[modelSource="'+c+'"]'),d;mojo._namespace(c);if(f.length){a(f).each(function(h,g){if(!g.mojoTemplate){g.mojoTemplate=a(g).html().replace("%7B%7B","{{").replace("%7D%7D","}}");}a(g).html("");var i=mojo.template(g.mojoTemplate,e);a(f).html(i);d=a(f).html();});return d;}else{window[c]=e;return window[c];}};b.get=function(c){if(!c){return false;}if("string"!=typeof c){return false;}if("undefined"==typeof mojo.ModelRegistry[c]){return false;}if(arguments.lenght>1){return false;}return mojo.ModelRegistry[c];};b.remove=function(c){if(!c){return false;}if("string"!=typeof(c)){return false;}if("undefined"==typeof mojo.ModelRegistry[c]){return false;}delete mojo.ModelRegistry[c];return true;};mojo.Model=b;mojo.ModelRegistry={};});mojo.define("mojo.Request",function Request(b){function a(f,c,e,d){if("undefined"==typeof f||!f){throw new Error("'paramsObj' is required");}if("undefined"==typeof c||!c){throw new Error("'callerObj' is required");}if("undefined"==typeof e||!e){throw new Error("'eventObj' is required");}if("undefined"==typeof d||!d){throw new Error("'controllerObj' is required");}this.paramsObj=f;this.callerObj=c;this.eventObj=e;this.controllerObj=d;}a.prototype.getController=function(){return this.controllerObj;};a.prototype.getContextElement=function(){return this.getController().getContextElement();};a.prototype.getCaller=function(){return this.callerObj;};a.prototype.getEvent=function(){return this.eventObj;};mojo.Request=a;});mojo.define("mojo.Controller",function(){var b=jQuery;var a=function(){};function c(){this.contextElement=null;this.controllerClass=null;this.events;}c.prototype.onInit=function(){};c.prototype.onParamChange=function(){};c.prototype.onComplete=function(){};c.prototype.onBind=function(){};c.prototype.onIntercept=function(){};c.prototype.params={};c.prototype.initialize=function(e,f,g){var d=this;d.contextElement=e;d.controllerClass=f;if("undefined"!=typeof g||!g){d.params=g;}b(d.events).each(function(l,k){var i=b(document),n=k[0],h=k[1],j=k[2],m=k[3];if(n=="context"){i=b(e);}b(i).delegate(h,j,function(o){d.onBind();var q=new mojo.Request(b(this).data()||{},this,o,d);if(typeof d.before!="undefined"&&typeof d.before[m]!="undefined"){d.before[m].call(d,q);d.onIntercept("Before");}if(!d.methods[m]||"undefined"==typeof d.methods[m]){throw new Error("Command does not exist within Controller");}try{d.methods[m].call(mojo.controllers[f],q);}catch(p){throw p;}if(typeof d.after!="undefined"&&typeof d.after[m]!="undefined"){d.after[m].call(d,q);d.onIntercept("After");}});});d.onInit();};c.prototype.getContextElement=function(){if(!this.contextElement){return null;}return this.contextElement;};c.prototype.param=function(d,e){if("undefined"==typeof this.params){this.params={};}if(arguments.length>1){this.params[d]=e;this.onParamChange();return this;}else{return this.params[d];}};mojo.Controller=c;});mojo.define("mojo.Application",function(){var g=jQuery;function e(){if(!this.options){this.options={};}var k=this,l=k.options;l.locale="en_CA";l.plugins=[];l.pluginSrc="js/lib/plugins/";l.pluginsAsync=true;l.environment="dev";l.logging=false;l.selector=jQuery||(function(){throw new Error("Unable to find jQuery");})();k.siteMap=[];}e.prototype.onComplete=function(){};e.prototype.configure=function f(k,m){if(!arguments.length){throw new Error("passing no parameters into configure() is invalid");}if(arguments.length>2){throw new Error("passing too many parameters into configure() is invalid");}if(arguments.length>1){this.options[k]=m;if(this.options.environment=="dev"&&("undefined"!=typeof this.options.logging&&this.options.logging)){try{console.info("Configure: ",k," -> ",m);}catch(l){}}return this;}else{return this.options[k];}};e.prototype.map=function b(k,n){if("undefined"==typeof k||!k){throw new Error("'selector' is a required parameter");}if("undefined"==typeof n||!n){throw new Error("'callback' is a required parameter");}if("string"!=typeof k){throw new Error("'selector' needs to be a String");}if(g.isArray(n)&&n.length===0){throw new Error("'callback' is an array and is required to have controllers");}if(g.isArray(n)){g(n).each(function(p,o){if(!o.hasOwnProperty("controller")){throw new Error("'callback' must contain only Mojo Controller objects");}});}var l=this;var m=g(k);m.each(function(o,p){l.siteMap.push({context:p,init:n});});if("function"==typeof n){n.call(this,l);}return this;};e.prototype.setupController=function i(l,k,p){if("undefined"==typeof l||!l){throw new Error("'context' is a required parameter");}if("undefined"==typeof k||!k){throw new Error("'controller' is a required parameter");}var n=g(l);var m=mojo.controllers[k];var o=new mojo.Controller(),m=g.extend(m,m.methods),m=g.extend(m,o);mojo.controllers[k]=m;if(typeof m=="undefined"){throw new Error("Undefined Controller @ ",k);}m.initialize(l,k,p);if("undefined"==typeof l.mojoControllers){l.mojoControllers=[];}l.mojoControllers.push({controller:m});if(typeof m.after!="undefined"&&m.after.Start!="undefined"){m.after.Start.call(m,null);}if("undefined"!=typeof m.methods.Initialize){m.methods.Initialize.call(m);}};e.prototype.disconnectController=function a(l,k){if("undefined"==typeof l||!l){throw new Error("'node' is a required parameter");}if("undefined"==typeof k||!k){throw new Error("'controller' is a required parameter");}g(l).unbind().undelegate();if("undefined"!=typeof g(l)[0].mojoControllers){delete g(l)[0].mojoControllers;}return this;};e.prototype.disconnectControllers=function h(l){var k=this;g(this.siteMap).each(function(m,n){g(n.context).unbind().undelegate();if("undefined"!=typeof g(n.context)[0].mojoControllers){delete g(n.context)[0].mojoControllers;}});if("undefined"!=typeof l&&"function"==typeof l){l.apply(this);}};e.prototype.connectControllers=function c(){var k=this,l=[];g(k.siteMap).each(function(n,m){var o;if("function"==typeof m.init){o=m.init.call(this);}else{o=m.init;}g(o).each(function(p,q){if(!mojo.controllers.hasOwnProperty(q.controller)){l.push(q.controller);}else{mojo._loaded[q.controller]=q.controller;}});});mojo.require(g.unique(l),function(){g(k.siteMap).each(function(n,m){if(k.options.environment=="dev"&&k.options.logging){try{console.log("Mapping ["+n+"]: ",m.context);}catch(p){}}var o=("function"==typeof m.init)?m.init.call(this):m.init;g(o).each(function(q,r){k.setupController(m.context,r.controller,r.params);});mojo.Messaging.publish("/app/start");});});};e.prototype.getPlugins=function(m){var k=this,l=k.options.pluginSrc;if(!k.options.pluginsAsync){g.ajaxSetup({async:false});}g(k.options.plugins).each(function(n,o){mojo.fetch(l+o+".js");});if(!k.options.pluginsAsync){g.ajaxSetup({async:true});}if("undefined"!=typeof m&&"function"==typeof m){m.call(k);}};e.prototype.start=function d(){var k=this;g(document).ready(function(){k.disconnectControllers(function(){if(k.options.plugins.length){k.getPlugins(function(){mojo.Messaging.publish("/app/plugins/loaded");k.connectControllers();});}else{k.connectControllers();}k.onComplete();});});};e.prototype.remap=function j(){var k=this;k.disconnectControllers(function(){k.connectControllers();k.onComplete();});};mojo.Application=e;});mojo.define("mojo.Service",function Service(a){function b(d,e,c){if(typeof c=="undefined"){c={};}var f={method:c.method||function(){var g="get";if(d.match(/^get/i)){g="get";}else{if(d.match(/^add|del|update/i)){g="post";}}return g;}(),jsonp:false,wrapped:false,template:false,contentType:"application/json; charset=utf-8"};this.name=d;this.uri=e;this.options=a.extend({},f,c);}b.prototype.invoke=function(e,h,i){var j=this;var k=j.getOptions()||{},c=k.method,d=j.getURI(),g=k.responseType||"JSON";if("undefined"==typeof h||!h){throw new Error("'callback' is a required parameter");}if(k.template){d=j.parse(d,e);if(c=="get"){e=null;}}a.ajaxSetup({dataTypeString:g,dataType:k.jsonp?"jsonp":g,type:c,async:k.async||true,cache:k.cache||false,contentType:k.contentType||"application/json; charset=utf-8"});var f;if(c=="post"&&k.contentType.match(/application\/json/gi)){f=JSON.stringify(e);}else{f=e;}a.ajax({url:d,data:f,headers:{RequestId:mojo.guid()}}).success(function(m){if(g=="JSON"&&this.contentType.match(/javascript/g)){m=a.parseJSON(m);}if(k.wrapped){m=j.unwrap(m);}if("undefined"!=typeof h){var l=[null,m,arguments[1],arguments[2]];mojo.Messaging.publish("mojo.Service."+j.getName(),{response:m,service:j});if(typeof h=="function"){h.apply(i,l);}else{i[h].apply(i,l);}}}).error(function(){if("undefined"!=typeof h){h.apply(i||this,arguments);}});};b.prototype.getName=function(){return this.name;};b.prototype.getURI=function(){return this.uri;};b.prototype.getOptions=function(){return this.options;};b.prototype.unwrap=function(e){var d=this;var c={};for(var f in e){if(typeof f==="string"&&f.substr(f.length-6,f.length)=="Result"){e=d.convert(e[f]);break;}}return e;};b.prototype.convert=function(e){var c={};for(var d in e){c[d]=e[d];}return c;};b.prototype.option=function(){if(!arguments.length){return false;}if(arguments.length>2){return false;}if("string"!=typeof arguments[0]){return false;}if(arguments.length==2){this.options[arguments[0]]=arguments[1];return this;}else{if(arguments.length==1){return this.options[arguments[0]];}}};b.prototype.parse=function(c,d){if(arguments.length!=2){return false;}if("string"!=typeof c){return false;}if("object"!=typeof d){return false;}a.each(d,function(e,f){c=c.split("{"+e+"}").join(f);});return c;};mojo.Service=b;});mojo.define("mojo.ServiceLocator",function ServiceLocator(b){var a={services:{},addService:function(c){if(!c){return false;}this.services[c.name]=c;return this;},getService:function(c){return this.services[c];},removeService:function(c){delete this.services[c];},removeServices:function(){this.services={};return true;},getServices:function(){if(typeof this.services===undefined){return false;}return this.services;}};mojo.ServiceLocator=a;});